\documentclass[master=cws, masteroption=vs]{kulemt}

% Vul de titel van jouw masterproef hieronder in tussen { en }.

\setup{title={Flip the virus:  Modelling targeted attacks using FlipIt with propagation delay},
%
% Vul hieronder namen in, steeds Voornaam Naam.
% Indien meerdere auteurs, assessoren, assistenten, scheidt hun namen
% met \and .
author={Sophie Marien},
promotor={Prof. dr. T. Holvoet},
assessor={Prof. dr. B. Jacobs \and Dr. ir. A. Dries},
assistant={Ir. Jonathan Merlevede, \and Ir. Kristof Coninx}}
% 
% De volgende \setup mag verwijderd worden als geen fiche gewenst is.
\setup{filingcard,
  translatedtitle={Flip the virus:  Modelling targeted attacks using FlipIt with propagation delay},
  udc=621.3,
  shortabstract={Recently, high profile targeted attacks such as the
attack on Belgacom (a major Belgian telcom), have demonstrated
that even the most secure companies can still be compromised,
and that moreover such attacks can go undetected for a while. These kind of attacks are called APT, advanced persistent threats, which are designed to penetrate secretly a computer network, collect sensitive data and stay hidden for many years. A company has every interest to mitigate the risks of an APT and the consequences that it can cause.  Because of the stealthiness fighting against these attacks requires methods that go beyond the standard tools against malware.
A group of researchers at the RSA, van Dijk et al., proposed the game FlipIt (The game of ``stealthy takeover'') to model stealthy takeovers. It is a 2-players game composed of
a single attacker, a single defender and a single shared resource.
The players will 
compete to get control over the shared resource. Every move of the players will involve a cost and
these moves happen in a stealthy way. The objective of the game for each player is to maximise the fraction of time of controlling the resource and minimise the total move cost.  \\
FlipIt does however not take into
account that a move may not be instantaneous, but has a certain
delay.  We adapt FlipIt such that we can use it to
model the game of defending a company network that is attacked
by a virus. The FlipIt formulas are adapted such as to take the
delay for virus propagation into account, which in our case will be a delay for the attacker. In this paper, we restrict ourselves to games where both the defender and the attacker play with a periodic strategy. The goal of this thesis is to find out if their are interesting Nash Equilibria for a game with a virus propagation delay and if we can learn some lessons out of it. }}
% Verwijder de "%" op de volgende lijn als je de kaft wil afdrukken
%\setup{coverpageonly}
% Verwijder de "%" op de volgende lijn als je enkel de eerste pagina's wil
% afdrukken en de rest bv. via Word aanmaken.
%\setup{frontpagesonly}

% Kies de fonts voor de gewone tekst, bv. Latin Modern
\setup{font=lm}

% Hier kun je dan nog andere pakketten laden of eigen definities voorzien
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{listings}
\usepackage{color}
\usepackage{soul}
\usepackage{tikz}
\usepackage{parskip}
\usepackage{todonotes}
\usepackage{url}
\usepackage{natbib} 
\usepackage{pgf}
\usepackage{tikz}
\usepackage{hyperref}
\usepackage[font={small,it}]{caption}
%\headstyles{kulemtman}


%\usepackage{float}
%\usepackage{caption}
%\usepackage[caption = false,subrefformat=parens,labelformat=parens]{subfig}
%\usepackage{todonotes}
%\usepackage{epstopdf}
%\usepackage{textcomp}
%\usepackage{gensymb}
%\usepackage[titlenumbered,algoruled, linesnumbered]{algorithm2e}
%\usepackage{algpseudocode}
%\usepackage{parskip}
%\usepackage{kulemtx}
%\headstyles{kulemtman}
%
%\DontPrintSemicolon



\usetikzlibrary{arrows,automata}
%\usepackage[latin1]{inputenc}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

%\lstset{frame=tb,
%  language=Java,
%  aboveskip=3mm,
%  belowskip=3mm,
%  showstringspaces=false,
%  columns=flexible,
%  basicstyle={\small\ttfamily},
%  numbers=none,
%  numberstyle=\tiny\color{gray},
%  keywordstyle=\color{blue},
%  commentstyle=\color{green},
%  stringstyle=\color{black},
%  breaklines=true,
%  breakatwhitespace=true
%  tabsize=3
%}

%\newcommand{\todo}[1]{{\huge \textcolor{green}{#1}}\\}
%\newcommand{\com}[1]{\textcolor{red}{#1}\\}
%\newcommand{\viscomment}[1]{\textcolor{red}{#1}}
\newcommand{\flip}[1] {\textcolor{black}{#1}}

% Tenslotte wordt hyperref gebruikt voor pdf bestanden.
% Dit mag verwijderd worden voor de af te drukken versie.
%\usepackage[pdfusetitle,colorlinks,plainpages=false]{hyperref}

%%%%%%%
% Om wat tekst te genereren wordt hier het lipsum pakket gebruikt.
% Bij een echte masterproef heb je dit natuurlijk nooit nodig!
\IfFileExists{lipsum.sty}%
 {\usepackage{lipsum}\setlipsumdefault{11-13}}%
 {\newcommand{\lipsum}[1][11-13]{\par Hier komt wat tekst: lipsum ##1.\par}}
%%%%%%%


%\includeonly{chap-n}
\begin{document}

\begin{preface}
Thank you !

%Ten slotte gaat mijn grootste dank uit naar mijn ouders. Zij leverden
%niet alleen een cruciale bijdrage aan het welslagen van deze
%meesterproef, maar zijn een belangrijke hulp voor mijn academische
%studies in het geheel. Zonder hen zou niets wat ik tot nu toe heb
%bereikt, mogelijk geweest zijn
% Many people have helped in the realization of this thesis. 
%  I would like to thank everybody who kept me busy the last year and made it possible for me to finish my thesis.\\
%  
%  First I would like to thank my promoter and my assistants for their excellent support during the writing of this paper. They helped me figure out what to do and put a lot of time and effort in me.\\
%  
%   
%   I would also like to thank my boyfriend who supported me during the writing of this thesis and helped me to write a beautiful text.  \\
%   
%   Last but not least all the people that read my thesis for faults: .. \\
%   A few other people earn a special mention: Revue-blokt for keeping me focused on my thesis, DistriNet labo for letting me in and study in a quit place, Antonio for distracting me and telling me stories about his travels.
%   A special memorial to John Nash, a mathematician with a fundamental contribution to Game Theory, that died in a car accident during the writing of this thesis. His Nash Equilibrium is used in this thesis.. \\
 
\end{preface}

\tableofcontents*
\listoftodos
\begin{abstract}

%  The \texttt{abstract} environment contains a more extensive overview of  the work. But it should be limited to one page.
  
Recently, high profile targeted attacks such as the
attack on Belgacom (a major Belgian telcom), have demonstrated
that even the most secure companies can still be compromised,
and that moreover that such attacks can go undetected for a while. This kind of attack is called APT, Advanced Persistent Threats, and designed to secretly penetrate a computer network, collect sensitive data and stay hidden for many years. Companies have every interest to mitigate the risks of an APT and the consequences that it can cause.  Because of stealthiness, fighting against this kind of attack requires methods that go beyond the standard tools against malware.\\
A group of researchers at the RSA, van Dijk et al., proposed the game FlipIt (The game of ``stealthy takeover'') to model stealthy takeovers. It is a 2-players game composed of
a single attacker, a single defender and a single shared resource.
The players will 
compete to get control over the shared resource. Every move of the players will involve a cost and
these moves happen in a stealthy way. The objective of the game for each player is to maximise the fraction of time being in control of the resource and minimise the total move cost.  \\
FlipIt does however not take into
account that a move may not be instantaneous, but may have a certain
delay.  We adapt FlipIt such that we can use it to
model the game of defending a company network that is attacked
by a virus. The FlipIt formulas are adapted such as to take the
delay for virus propagation into account, which in our case will be a delay for the attacker. In this paper, we restrict ourselves to games where both the defender and the attacker play with a periodic strategy. The goal of this paper is to find out if modelling such situations with FlipIt with propagation delay allows us to draw interesting lessons about security measures against APT's.  
\todo{Results toevoegen} \\

\textbf{Keywords}: Game theory, Advanced persistent threats, cyber security, FlipIt, stealthy takeovers, propagation methods.

\end{abstract}

\begin{abstract*}
Nederlandse abstract
---TODO dit stuk moet nog geschreven worden --- \\

Security is een niet te missen aspectgeworden in de technologie. Door de vooruitgang en betere technologie"en worden security aanvallen veel geavanceerder en moeilijker te bestrijden. Onlangs zijn er gerichte security aanvallen geweest op grote bedrijven, zoals de aanval op Belgacom (een grote Belgische telcom). Deze aanvallen hebben aangetoond dat zelfs de meest veilige
bedrijven nog steeds gecompromitteerd kunnen worden, en dat bovendien dergelijke aanvallen onopgemerkt kunnen blijven voor een bepaalde tijd. \\

Vele bedrijven hebben grote databases die belangrijke informatie bevatten zoals bijvoorbeeld vertrouwelijke informatie over klanten. Het is belangrijk dat deze informatie binnen het bedrijf blijft. Computer en Network security zorgt ervoor dat bedrijven hun informatie kunnen beschermen tegen bedrijgingen. \\
Een van deze bedrijgingen die interessant is voor deze paper is een Advanced Persistent Threat (APT). Een APT is een continue en gerichte cyber aanval die ontworpen is om systemen en netwerken heimelijk binnen te dringen en dan voor een lange tijd onopgemerkt te blijven. Een manier om deze heimelijke aanvallen te analyseren is door het te modelleren via speltheorie. Speltheorie krijgt meer en meer belangstelling in het veld van security om cyber security problemen te modelleren. Deze problemen worden meestal gemodelleerd als een spel met twee spelers, een aanvaller en een verdediger. Er zijn ook probelemen die gemodelleerd kunnen worden als spelen met meerdere spelers, maar in de paper wordt gefocust op een spel met twee spelers. \\

In deze paper gaan we verder op een security spel ge"introduceerd door van Dijck et al, ``FlipIt'' \citep{FlipIt}.
Flipit is een speltheoretisch framework om computer scenarios te modelleren die een sthealty aspect hebben. Het is een 2-spelers spel bestaande uit een aanvaller, een verdediger en een gedeelde bron.  De spelers proberen om controle te krijgen over de gedeelde bron en ze
doen dit op een heimelijke manier. Met FlipIt wordt echter geen rekening mee gehouden dat een aanval niet onmiddellijk is, maar dat dit kan gebeuren met een zekere vertraging. In dit artikel passen we het model van FlipIt zodanig aan dat we het kunnen gebruiken voor heimelijke aanvallen die onderheven zijn aan een vertraging.
Resultaat : \\

Flipit is een spel ge"introduceerd door Van Dijk et al. Om te begrijpen hoe we het FlipIt spel kunnen aanpassen om virus propagatie in acht te nemen, is het belangrijk om vertrouwd te raken met de concepten van het basische Flipit spel en de notaties. Daarom beginnen we eerst met een uitleg hoe het basische FlipIt spel werkt en de belangrijkste formules die we in de paper gebruiken. \\

Flipit is een spel met twee spelers met een gedeelde bron die de spelers zo lang mogelijk willen beheren. De gedeelde bron kan een wachtwoord, een netwerk of een geheime sleutel zijn afhankelijk van welke situatie gemodelleerd wordt. In de rest van de paper noemen we de twee spelers de aanvaller, aangegeven met onderschrift  \textit{A} en de verdediger, aangegeven met onderschrift \textit{D}.

Het spel begint op tijdstip $ t = 0 $ en blijft voor onbepaalde tijd doorgaan ($ t \rightarrow \infty $). De tijd van het spel wordt aangenomen als continu. Om controle over de bron te krijgen kunnen de spelers $i$, met $ i \in \{A, D \} $ de bron flippen. Elke flip impliceert een zekere kost $ k_{i} $ en deze kosten kunnen vari"eren voor elke speler. Beide spelers proberen om hun kosten te minimaliseren. Door een kost in te voeren, voorkomt men dat de spelers te vaak bewegen. \\

De unieke eigenschap van Flipit is dat elke flip gebeurt op een heimelijke manier. Dit betekent dat de speler geen weet heeft over wie de controle heeft over de bron. Zo zal de verdediger niet kunnen achterhalen of de bron al is gefipt door de aanvaller tot hij de bron zelf flipt. Het doel van elke speler is om zo lang mogelijk de controle te behouden over de bron en tegelijkertijd de kost van de bewegingen te minimaliseren. Een beweging kan ook leiden tot een ``verloren bewegin'', genoemd een flop. Het kan gebeuren dat de bron reeds onder controle is van de speler. Als de speler flipt wanneer hij of zij al de controle  heeft over de bron, dan verspilt de speler een zet omdat het niet leidt tot een verandering van controle en dus een kost verspilt wordt. \\


\begin{figure}[hbtp]
\center
\includegraphics[scale=0.5]{../../doc/template/Images/DefFlipit}
\caption{Een afbeelding van een Flipit spel met discrete tijdsintervallen waarbij beide spelers periodiek spelen. Elke beweging of flip wordt aangegeven met een blauwe ( donkergrijs) of oranje (lichtgrijze) cirkel. De aanvaller is vertegenwoordigd in het oranje en speelt met een periode van $ \delta_{A} = 4 $. De verdediger is vertegenwoordigd in het blauw en speelt met een periode van $ \delta_{D} = 3 $. De blauwe en oranje rechthoeken geven de hoeveelheid tijd die de betreffende speler in de controle is van de bron.}
\label{fig: FLipItDefault}
\end{figure}



De toestand van de bron wordt aangeduid als een tijdsafhankelijke variabele $ C = C_{i}(t) $.
$ C_{D}(t) $ 1 is als het spel onder controle is van de verdediger en 0 als het spel onder controle is van de aanvaller. Omgekeerd, zal $ C_{A}(t) $ 1 zijn als het spel onder controle is van de aanvaller en 0 als onder controle van de verdediger. Dus, $ C_{A}(t) = 1 - C_{D}(t) $.
Het spel begint met de verdediger in controle: $ C_{D}(0) = 1 $. \\


De spelers krijgen een benefit gelijk aan de hoeveelheid tijd dat ze in het bezit zijn van de bron min de kosten voor het maken van de bewegingen. De kosten van een speler \textit{i} worden aangegeven met $ k_{i} $.
De totale winst van de speler \textit{i} is gelijk aan de totale hoeveelheid tijd waarbij een speler \textit{i} in controle is can de bron vanaf het begin van het spel tot de huidige tijd \textit{t}. Dit wordt als volgt uitgedrukt:
\begin{equation}
G_{i}(t) = \int_0^t \! C_{i}(x) dx.
\end{equation}
De totale winst van de verdediger opgeteld bij de totale winst van de aanvaller telt op tot \textit{t}:
\begin{equation} 
G_{D}(t) + G_{A}(t) = t
\end{equation}
De gemiddelde winst van speler \textit{i} wordt gedefinieerd als volgt:
\begin{equation}
\gamma_{i}(t) = G_{i}(t) / t.
\end{equation}
En daarmee voor alle $ t> 0 $:
\begin{equation} 
\gamma_{D}(t) + \gamma_{A}(t) = 1
\end{equation}
$ \alpha_{i} $ definieert het gemiddeld aantal flippen door speler \textit{i} tot tijd \textit{t}.
Laat $ \beta_{i}(t) $ is de gemiddelde benefit van een speler \textit{i} tot aan tijd \textit{t}:
\begin{equation}
\beta_{i}(t) = \gamma_{i}(t) - k_{i} \alpha_{i}.
\end{equation}
Dit is gelijk aan de fractie van de tijd waarbij de bron in handen is van speler \textit{i}, minus de kosten van het maken van de bewegingen. ~ 
Gedurende het spel wordt de asymptotische benefit ratio gedefinieerd als lim inf van de gemiddelde benefit omdat de tijd t toeneemt tot oneindig en de gemiddelde benefit heeft niet altijd een limiet.
\begin{equation}
\beta_{i} (t) = \lim_{t \to \infty } inf \beta_{i}(t)
\end{equation}
\\


\subsubsection{Strategie"en}
Omdat de spelers op een heimelijke manier bewegen, zijn er verschillende soorten feedback die een speler kan krijgen tijdens het flippen. Dergelijke feedback kan worden verdeeld in twee groepen van strategie"en. De niet-adaptieve strategie"en en de adaptieve strategie\"en. Deze worden beschreven in de tabel \ref{tabel: Strategies}. \\

DE niet adaptieve strategi"en zijn de strategi"en waarbij geen van beide spelers feedback krijgen. 
Als er geen feedback voor geen van beide spelers, hebben wij een niet-adaptieve strategie. Hierdoor zal de speler die geen feedback tijdens een spel steeds spelen op dezelfde manier tegen elke tegenstander. De strategie is niet-adaptieve omdat de speelstrategie niet afhankelijk is van de bewegingen van de tegenstander. Een interessante subklasse van de niet-adaptieve strategie"en is degene waarbij de tijdsintervallen tussen twee opeenvolgende bewegingen worden gegenereerd door een vernieuwingsproces. Een voorbeeld hiervan is de periodieke strategie waarbij het tijdsverloop tussen twee opeenvolgende bewegingen van de spelers bepaald is door een vast interval. Een exponenti"ele strategie is een vernieuwingsstrategie waarbij het interval tussen twee opeenvolgende zetten exponentieel verdeeld is. \\

In het geval van feedback kan een speler kan zijn strategie aanpassen aan de informatie verkregen over de bewegingen van de tegenstander. Afhankelijk van de feedback kunnen twee subklassen van adaptieve strategie"en worden ge"identificeerd. The Last Move (LM) strategie"en vertegenwoordigen de klasse waarbij een speler de exacte tijd te weten komt van de laatste flip van de tegenstander als de speler flipt. In de tweede klasse, genaamd Full History (FH), wanneer een speler flipt, krijgt hij de hele geschiedenis van de beweging van de tegenstander. \\
Dit artikel focust op de niet-adaptieve strategie"en.  \\


 \begin{table}
 \center
 \begin {tabular} {l | c}
  \textbf{Categories} & \textbf{Klassen Strategien} \\
  \hline Niet-adaptieve (NA) & Renewal \\
  & - Periodieke \\
  & ~~~ - Exponenti"ele \\
  & General niet-adaptieve \\
  \hline Adaptive (AD) & Last move (LM) \\
  & Full History (FH) \\
\end{tabular}
 \caption{hi"erarchie van de klassen van de strategie"en in Flipit}
 \label{tabel: Strategies}
 \end{table}


Het onderzoek van de verschillende strategie"en middels Flipit framework stelt een aantal interessante resultaten leiden:
\begin{itemize}
\item periodieke spellen domineren de andere Renewal strategie"en. Dit Dit betekent dat het altijd voordeliger is om een periodieke strategie te spelen tegen een tegenstander met een Renewal strategie;
\item periodieke spellen zijn nadelig tegen spelers die de Last Move adaptieve strategie gebruiken;
\item als de verdediger speelt met een periodieke snelheid die snel genoeg is dan zal hij de aanvaller dwingen te stoppen met het spel;
\item elke hoeveelheid van feedback ontvangen over de tegenstander tijdens het spel, geeft een voordeel aan een speler.
%item een ​​bedrag van feedback over de tegenstander ontving tijdens het spel, de voordelen aan een speler.
\end{itemize}


\section {Flipit Met viruspropagatie}
\label{ch: flipitvirus}
Een Flipit spel bestaat uit een enkele bron. Om de veiligheid probleem vertegenwoordigen, het spel nu STD defini"eren als een enkele bron met meerdere computernetwerk
geef niet. Een van de spelers, de verdediging, zal proberen om zijn netwerk te verdedigen. De verdedigende
esta zal doen omkeren door alle knooppunten van het netwerk (dwz De gehele bron) in elke beweging die ik toneelstukken. De
aanvaller de andere spelers zullen proberen om alle knooppunten in het netwerk infecteren. De aanvaller
Zal dit doen door flipping het knooppunt in de grafiek Dat kan alle knooppunten in het infecteren
kortst mogelijke tijd. Na het laten vallen van een virus op het eerste knooppunt, het duurt een tijdje voor het virus om het gehele netwerk te infecteren. Omdat de Flipit spel Original werkt met een enkele bron die altijd volledig wordt omgedraaid, wordt de aanname gemaakt van oordeel dat de aanvaller is om onmiddellijk de volledige controle te krijgen over de bron Wanneer het netwerk is ge"infecteerd, ook al is het maar een knooppunt Dat heeft besmet . \\

In werkelijkheid echter, na het laten vallen van een virus op het eerste knooppunt, het duurt een tijdje voor het virus te infecteren
Het gehele netwerk. Dus de veronderstelling dat de aanvaller volledige controle over de bron zodra een knooppunt is-besmet, is niet realistisch. De aanvaller heeft slechts 11:00 controleren alle van het netwerk of een voldoende aantal knooppunten zijn besmet.
De tijd die nodig is om het virus infecteren elk knooppunt (of een voldoende aantal knooppunten) wordt
aangeduid als een infectie-vertraging Variable \textit{d} (de zogenaamde "vertraging" voor kort in de rest van esta papier). Als we willen om te meten hoe lang het duurt voor het virus om
infecteren alle knooppunten in het netwerk, moeten we de kortste weg van de berekening
eerste besmette knooppunt naar de verste knooppunt. In plaats aanduiding van de tijd die nodig is voor het infecteren alle knooppunten, kan de variabele $ d $ ook worden gebruikt om de tijd die nodig is om \textit{a} voldoende aantal knooppunten infecteren duiden.

Veronderstel dat een aanvaller aanvallen op het moment \ textit {t}, ik niet onmiddellijke controle over de bron te krijgen, maar ik alleen maar winst beheersen op het moment \ textit {t + d} Met $ d $ aanduiding van de tijd die nodig is om een te infecteren Voldoende nummer (of alle) knooppunten. Als de klep te verdedigen het netwerk voordat de periode $ d $ verstreken is (dus ergens tussen de $ t $ en $ t + d $), Dan is de aanvaller zal nooit volledige controle over de bron te krijgen. Dit impliceert dat de wiskundige formules voor de winst en voordeel moeten worden aangepast aan het feit dat de aanvaller verliest een deel van zijn voordeel esta Vanwege vertraging. In de rest van esta papier, zullen we de formalisering van de Flipit spel aan te passen met behulp van de variabele $ d $. \\

Formalisering begint bij het model van de niet-adaptieve Wanneer continue basis Flipit spelers gebruiken periodieke strategie met willekeurige fase. Deze keuze wordt ingegeven door de veronderstelling dat in de meeste organisaties, de verdediging strategie is om het netwerk Periodiek verdedigen. Deze periodieke komt overeen met een defensiestrategie. Een periodieke aanvaller strategie wordt ook uitgegaan In staat om de resultaten te vergelijken met de periodieke strategie van het spel Flipit in \cite{Flipit}. %, As esta ook overeen met een real-life gemeenschappelijke strategie. % Nog verder Eventueel je motiveren
Verder onderzoek kan het effect van ontspannende esta veronderstelling te onderzoeken. \\

Op dezelfde manier als in cite{}Flipit, we deelden de formalisering in twee gevallen. Het eerste geval is waar het verdedigen speelt Minstens zo snel als de aanvaller, het tweede geval is wanneer de aanvaller speelt Minstens zo snel als de te verdedigen. Voor elk van deze gevallen eerst het voordeel formule van de fundamentele zaak zonder vertraging wordt gepresenteerd, en dan de vertraging wordt ge"introduceerd. \\

\subsection{Formalization the benefit formula including the infection-delay}
 A Periodic strategy is a non-adaptive renewal strategy where the time intervals between consecutive moves are a fixed period, denoted by $\delta$. Moreover it has a random phase, that is chosen uniformly and random in the interval $[0,\delta]$ for the first move. The average rate of play of a player is denoted by $\alpha_{i} = \dfrac{1}{\delta_{i}}$. \\
~~\\

\subsection*{\textbf{Case 1:} $\delta_{D} \leq \delta_{A} $ (The defender plays at least as fast as the attacker.) }

Let $r = \dfrac{\delta_{D}}{ \delta_{A} }$. The intervals between two consecutive defender's moves have length $\delta_{D}$. Consider a given defender move interval. The probability over the attacker's phase selection that the attacker moves in this interval is r. Given that the attacker moves within the interval, he moves exactly once within the interval (since $\delta_{D} \leq \delta_{A} $) and his move is distributed uniformly at random. \\

The expected period of attacker control within the interval would be r/2, without considering the delay by a virus. Therefore the benefit for the attacker, without considering the delay, can be expressed as follows:

\begin{equation}\label{first}
\beta_{A}(\alpha_{D},\alpha_{A}) =\dfrac {r} {2} - k_{A} \alpha_{A} = \dfrac {\delta_{D}} {2\delta_{A}} - k_{A} \alpha_{A}  
\end{equation}\\

Correspondingly, the benefit for the defender can be expressed as:
\begin{equation}\label{first}
\beta_{D}(\alpha_{D},\alpha_{A}) =1 -  \dfrac {r} {2} - k_{D} \alpha_{D} = 1 - \dfrac {\delta_{D}} {2\delta_{A}} - k_{D} \alpha_{D} 
\end{equation}

\begin{figure}[hbtp]
\caption{The first FlipIt game is one without virus propagation. The second one is with virus propagation and \textit{d} = 1. The delay is denoted with an arrow.}
\centering
\includegraphics[scale=0.4]{../../doc/template/Images/FLipItCase1.pdf}
\label{fig:delaycase1}
\end{figure}


However, because of the delay required for virus propagation, the maximal time of control is reduced to $\delta_{D}-d$ , see figure \ref{fig:delaycase1}. There is a probability of \textit{r} that the attacker will move in the interval of the defender. However, the gain will not be half of the interval. Indeed, the attacker has to play soon enough to gain control, meaning that the attacker has to play during the period of $\delta_{D}-d$ during the interval of the defender. The probability that the attacker plays soon enough is $\dfrac{\delta_{D}-d}{\delta_{D}}$ and this will give the attacker an average gain of $\dfrac{\delta_{D}-d}{2}$. If the attacker moves after the period of $\delta_{D}-d$, the gain of the attacker will be zero. The probability that this happens is  $\dfrac{d}{\delta_{D}}$. The average gain rate of the attacker can then be expressed as follows if we look at one interval of the defender:
\begin{equation}\label{first}
\gamma_{A}(\alpha_{D},\alpha_{A}) = \dfrac {1}{\delta_{D}} [ \dfrac{\delta_{D}}{\delta_{A}} \cdot \dfrac{\delta_{D}-d}{\delta_{D}} \cdot \dfrac{\delta_{D}-d}{2} + \dfrac{\delta_{D}}{\delta_{A}} \cdot \dfrac{d}{\delta_{D}} \cdot 0 ]
\end{equation}

To derive the benefit, the cost of moving is subtracted from the average gain. 
\begin{equation}\label{first}
\beta_{A}(\alpha_{D},\alpha_{A}) = \dfrac { (\delta_{D}-d) ^{2}} {2 \cdot \delta_{D}  \delta_{A}} - k_{A} \alpha_{A}
\end{equation}
\begin{equation}\label{first}
\beta_{A}(\alpha_{D},\alpha_{A}) = \dfrac { \delta_{D}} {2 \cdot \delta_{A}} - k_{A} \alpha_{A} - ( \dfrac{d^{2}}{2 \cdot \delta_{A} \delta_{D}} - \dfrac{d}{\delta_{A}} )
\end{equation}
 
 
 The benefit of the defender is expressed as follows:
 \begin{equation}\label{first}
\beta_{D}(\alpha_{D},\alpha_{A}) = 1 - \dfrac { (\delta_{D}-d) ^{2}} {2 \cdot \delta_{D}  \delta_{A}} - k_{D} \alpha_{D}
\end{equation}
~~\\
We can easily see that when $d$=0, we obtain the formula of the original FlipIt game.\\


\subsection*{\textbf{Case 2:} $\delta_{A} \leq \delta_{D} $ (The attacker plays at least as fast as the defender.) }

First let $r = \dfrac{\delta_{D}}{ \delta_{A} }$. The intervals between two consecutive attacker's moves have length $\delta_{A}$. Consider a given attackers move interval. The probability over the attacker's phase selection that the defender moves in this interval is $\dfrac{\delta_{A}}{ \delta_{D} } = (1/r)$. Given that the defender moves within the interval of the attacker, he moves exactly once within this interval (since $\delta_{A} \leq \delta_{D} $) and his move is distributed uniformly at random. \\

A similar analysis as in case 1 for a FlipIt game without virus propagation yields the following benefits:

\begin{equation}\label{first}
\beta_{D}(\alpha_{D},\alpha_{A}) = \dfrac {1} {2r} - k_{D} \alpha_{D} = \dfrac {\delta_{A}} {2\delta_{D}} - k_{D} \alpha_{D} 
\end{equation}
\begin{equation}\label{first}
\beta_{A}(\alpha_{D},\alpha_{A}) =1 - \dfrac {1} {2r} - k_{A} \alpha_{A} = 1- \dfrac {\delta_{A}} {2\delta_{D}} - k_{A} \alpha_{A}  
\end{equation}\\


For the case with a virus we consider two cases, Case a and Case b, depending on whether the delay is shorter or longer than the difference between the attacker's and the defender's period.  \\


\subsubsection*{\textbf{Case a:} $d + \delta_{A} \leq \delta_{D}$}
~~\\
Consider a timespan $\delta_{A} + d$, representing the attacker's interval followed by the delay period in his next interval. The defender will never move twice during this timespan because $\delta_{A} + d \leq \delta_{D}$. The defender will move during the interval of the attacker with a probability of $\dfrac{\delta_{A}}{\delta_{D}} $. When this happens the defender will end with being in control at the end of the interval. In the next interval the attacker will have to regain control, meaning that during the delay, the defender stays in control, see figure \ref{fig:case2} cases (1) and (2). This means that the defender will keep the control over the resource in the next interval over a period of the delay, namely \textit{d}. Because $d + \delta_{A} \leq \delta_{D}$ the next move of the defender in this second interval will never occur during the delay, meaning that the entire delay can be considered as an extra benefit resulting of a play in the previous interval. 
So, every time the defender plays, he will get an average gain of $\dfrac{\delta_{A}}{2}$ in the interval where he plays and in the next interval will always receive a extra gain of $d$, yielding a total average gain per interval of
$\dfrac{(d+\dfrac{\delta_{A}}{2})}{\delta_{A}}$

The total gain  rate of the defender is then the probability that the defender will move during an interval of the attacker multiplied by the total average gain per interval: 

\begin{equation}\label{first}
\gamma_{D}(\alpha_{D},\alpha_{A}) = \dfrac{\delta_{A}}{\delta_{D}} \cdot \dfrac{(d+\dfrac{\delta_{A}}{2})}{\delta_{A}} 
\end{equation}
\begin{equation}\label{first}
\gamma_{D}(\alpha_{D},\alpha_{A}) = \dfrac{\delta_{A}}{2\delta_{D}} + \dfrac{d}{\delta_{D}} 
\end{equation}\\
This yields in the following benefit formula:
\begin{equation}\label{first}
\beta_{D}(\alpha_{D},\alpha_{A}) = \dfrac{\delta_{A}}{2\delta_{D}} + \dfrac{d}{\delta_{D}} - k_{D} \alpha_{D} 
\end{equation}\\

The benefit for the attacker will be as follows:
\begin{equation}\label{first}
\beta_{A}(\alpha_{D},\alpha_{A}) = 1 -\dfrac{\delta_{A}}{2\delta_{D}} - \dfrac{d}{\delta_{D}} - k_{A} \alpha_{A} 
\end{equation}\\

\begin{figure}[hbtp]
\caption{Case 2 where d + deltaA < deltaD}
\centering
\includegraphics[scale=0.5]{../../doc/template/Images/FlipItCase2.png}
\label{fig:case2}
\end{figure}


It is crucial that $ \delta_{D}$ is at least as large as $d + \delta_{A}$. If not, this would mean that the defender can move during the delay in the interval following the interval where the defender already moved. This would mean that there can be an overlap between the average gain of $\dfrac{\delta_{A}}{2}$ and the delay. The above benefit formula would then include to much gain for the defender: the potential overlap during the delay would be counted twice. \\


~~ \\
\subsubsection*{\textbf{Case b:} $d + \delta_{A} \geq \delta_{D}$}
~~~\\

To obtain the formula in case of a too long delay, we therefore need to subtract this overlapping gain from the above formula. 
Since $\delta_{D} \geq \delta_{A}$, if the defender enters the interval immediately after the attacker has played, then the defender cannot have played in the previous interval. In that case, there is no overlap. So the problem of the overlap only appears if the defenders enters late enough and thus only the last part of the delay is subject to overlap. The larger the difference between the interval of the defender and the attacker, the smaller the risk of overlap. Concretely, only the last part of length $d - (\delta_{D} - \delta_{A})$ is subject to overlap. Hence, the probability of overlap is $\dfrac{ d - (\delta_{D} - \delta_{A})}{\delta_{D}}$ and the gain will be half of this interval:  $\dfrac{ d - (\delta_{D} - \delta_{A})}{2}$.  The gain rate to be subtracted is therefore:\\

\begin{equation}\label{first}
\dfrac{1} {\delta_{A}} \cdot \dfrac{d - (\delta_{D} - \delta_{A})}{\delta_{D}} \cdot \dfrac{d - (\delta_{D} - \delta_{A})}{\delta_{D}}
\end{equation}

The total gain  rate of the defender is obtained by subtracting this term from the gain rate of case a:
 \begin{equation}\label{first}
\gamma_{D}(\alpha_{D},\alpha_{A}) = \dfrac{\delta_{A}}{\delta_{D}} \cdot \dfrac{(d+\dfrac{\delta_{A}}{2})}{\delta_{A}} - \dfrac{(d - (\delta_{D} - \delta_{A}))^{2}}{2 \delta_{D} \delta_{A}}
\end{equation}
\begin{equation}\label{first}
\gamma_{D}(\alpha_{D},\alpha_{A}) = \dfrac{\delta_{A}}{2\delta_{D}} + \dfrac{d}{\delta_{D}} - \dfrac{(d - (\delta_{D} - \delta_{A}))^{2}}{2 \delta_{D} \delta_{A}}
\end{equation}\\
This yields in the following benefit formula:
\begin{equation}\label{first}
\beta_{D}(\alpha_{D},\alpha_{A}) = \dfrac{\delta_{A}}{2\delta_{D}} + \dfrac{d}{\delta_{D}} - k_{D} \alpha_{D} - \dfrac{(d - (\delta_{D} - \delta_{A}))^{2}}{2 \delta_{D} \delta_{A}}
\end{equation}\\
 
The benefit for the attacker will be as follows:
\begin{equation}\label{first}
\beta_{A}(\alpha_{D},\alpha_{A}) = 1 -\dfrac{\delta_{A}}{2\delta_{D}} - \dfrac{d}{\delta_{D}} - k_{A} \alpha_{A} + \dfrac{(d - (\delta_{D} - \delta_{A}))^{2}}{2 \delta_{D} \delta_{A}}
\end{equation}\\


\section{Nash Equilibrium}
Verder door schrijven

\section{Conclusions and Further Research}
\label{ch:conclusion}
In this paper we presented an adaptation of the FlipIt game to the situation of virus propagation, such as to take the delay for network infection into account. We discerned two cases. In the case the defender plays faster than the attacker, the attacker simply looses the delay. In the case the attacker plays faster, each time the defender plays in an interval, he will gain extra time of the delay. The delay is therefore always detrimental to the benefit of the attacker. 
This demonstrates that the FlipIt game can be adapted to a game with virus propagation. Further research needs to be performed to calculate the impact of the delay on Nash equilibria and the determination of optimal defender and attacker strategies.
%In dit \textit{abstract} environment wordt een al dan niet uitgebreide
%Nederlandse samenvatting van het werk gegeven.
%Wanneer de tekst voor een Nederlandstalige master in het Engels wordt
%geschreven, wordt hier normaal een uitgebreide samenvatting verwacht,
%bijvoorbeeld een tiental bladzijden. \\
%  
%Dit is het kort geschreven.\\ Eigenlijk paper in het nederlands schrijven \\
%Intro -- positionering -- vraagstelling -- oplossingen en contributies \\
%Flipit en cybersecurity\\
%Flipit met delay \\
%Berekeningen \\
%Niet zo lang geleden werden APT's ontdekt. (Introzin moet beter en anders). Bedrijven worden door APTs aangevallen. Belangrijk om APTs tegen te gaan. Geven een grote kost aan de bedrijven. Hun stealthy aspect is vervelend en moeilijk aan te pakken. Preventie is beter dan detectie. Eens ze binnen zijn kunnen we veel schade veroorzaken. Conventionele middelen zoals firewalls, malware detection helpen hier niet tegen. Nieuwe methode nodig. Gametheory FlipIt. FlipIt uitleggen. Deze formules gaan we dan omvormen tot ze wel propagatie delay kunnen modelleren. Hiervan berekenen we ook het Nash equilibrium. 
\end{abstract*}

% Een lijst van figuren en tabellen is optioneel
%\listoffigures
%\listoftables
% Bij een beperkt aantal figuren en tabellen gebruik je liever het volgende:
\listoffiguresandtables
% De lijst van symbolen is eveneens optioneel.
% Deze lijst moet wel manueel aangemaakt worden, bv. als volgt:
\chapter{List of Abbreviations and Symbols}
\section*{Abbreviations}
\begin{flushleft}
  \renewcommand{\arraystretch}{1.1}
  \begin{tabularx}{\textwidth}{@{}p{12mm}X@{}}
    RSA & Rivest-Shamir-Adleman \\
    DDoS & Distributed Denial of Service \\
    APT & Advanced Persistent Threat \\
    CIA & Confidentiality , Integrity and Availability \\
    USB & Universal Serial Bus \\
    NA & Non-Adaptive \\ 
    AD & Adaptive \\
    LM & Last Move \\
    FH & Full History \\
    VM & Virual Machine \\
    IP & Internet Protocol \\
    DNS & Domain Name System \\
    BGP & Border Gateway Protocol \\
    SEM & Simple Epidemic Model \\
    SIR & Susceptible - Infected - Recovered \\
    SIS & Susceptible - Infected - Susceptible \\
      \end{tabularx}
\end{flushleft}
\section*{Symbols}
\begin{flushleft}
  \renewcommand{\arraystretch}{1.1}
  \begin{tabularx}{\textwidth}{@{}p{12mm}X@{}}
 $i$ & $i \in \{D,A\}$, defines the player. `D' is the defender and `A' is the attacker. \\
 $\delta_{i}$ & The length of the interval between two consecutive moves of player \textit{i}. \\
 $\alpha_{i}$ & The average flip rate of player \textit{i}, given by $\alpha_{i}=1/\delta_{i}$. \\
$k_{i}$ & The cost of player \textit{i}'s moves. \\
$d$ & The delay caused by the propagation of a threat. \\
 $G_{i}(t)$ & The total gain of player \textit{i} denotes the amount of time player \textit{i} is in control over the resource up to time \textit{t}. \\
$\gamma_{i}$ & The average gain rate of player \textit{i} defined as $G_{i}(t)/t$. \\
$\beta_{i}$ &  The average benefit rate up to time \textit{t} defined as  $\beta_{i} = \gamma_{i} -k_{i} \alpha_{i} $. \\
$opt_{i}$ & The optimum function. \\
  \end{tabularx}
\end{flushleft}

% Nu begint de eigenlijke tekst
\mainmatter

%\include{intro}
\include{chap-10}
%gebruik van mijn model kan bevoorbeeld gebruikt worden om aan te duiden hoe vaak paswoorden moeten worden veranderd. 

%\include{chap-1}
\include{chap-5}
\include{chap-9}



\include{nash}
\include{chap-4}
%\include{chap-3} Related work
%\include{chap-6}
%\include{chap-7}
%\include{chap-8}
%\include{chap-9}
% ... en zo verder tot
%\include{chap-n}
\include{conclusion}

% Indien er bijlagen zijn:
%\appendixpage*          % indien gewenst
%\appendix
%\include{app-A}
% ... en zo verder tot
%\include{app-n}

\backmatter
% Na de bijlagen plaatst men nog de bibliografie.
% Je kan de  standaard "abbrv" bibliografiestijl vervangen door een andere. plainnat
\bibliographystyle{abbrv}
\bibliography{reffiess}

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 

%@Misc{Coursera,
%author = {Coursera},
%title = {Game Theory by Matthew O. Jackson, Kevin Leyton-Brown, Yoav Shoham},
%howpublished = {https://class.coursera.org/gametheory-004}, last checked on 2015-02-22}
%}
%
%
%@Misc{Symantec,
%author = {Symentec},
%title = {2014 Internet Security Threat Report, Volume 19},
%howpublished = {http://www.symantec.com/content/en/us/enterprise/other-resources/b-istr-appendices-v19-221284438.en-us.pdf}, last checked on 2015-02-22}
%}